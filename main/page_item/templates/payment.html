{% extends "base.html" %}

{% block title %}Payment for {{ item.title }}{% endblock %}

{% block content %}
<div class="container mt-5">
  <h2>Payment for {{ item.title }}</h2>
  <p>Your winning bid: Â£{{ "%.2f"|format(item.highest_bid().bid_amount if item.highest_bid() else item.minimum_price) }}</p>
  <div id="payment-message" role="alert" class="mt-3 text-danger"></div>
  <button id="checkout-button" class="btn btn-primary mt-3">Checkout</button>
</div>

<!-- Load Stripe.js -->
<script src="https://js.stripe.com/v3/"></script>
<script>
  // Generate a full external URL using localhost and the HTTP scheme.
  window.createCheckoutSessionUrl = "{{ url_for('item_page.create_checkout_session', url=item.url, _external=True, _scheme='http') }}";
  window.stripePublishableKey = "{{ stripe_publishable_key }}";
</script>
<script src="{{ url_for('static', filename='js/payment.js') }}"></script>
{% endblock %}
